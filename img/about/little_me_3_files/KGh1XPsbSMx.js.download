if (self.CavalryLogger) { CavalryLogger.start_js(["hX2Mx"]); }

__d("TimelineCollectionItemReorder",["csx","AsyncRequest","DataStore","DOMQuery","OGCollectionAddObject","Parent","SortableGroup","TimelineAppCollection","$"],(function(a,b,c,d,e,f,g){__p&&__p();var h="item-reorder-inst",i=function(){"use strict";__p&&__p();function a(a,c){this._collectionToken=c,this._initSorting(),b("DataStore").set(b("$")(a),h,this),b("TimelineAppCollection").subscribe(b("TimelineAppCollection").NEW_ITEM,this._processNewItem.bind(this,a)),b("OGCollectionAddObject").subscribe(b("OGCollectionAddObject").NEW_ITEM,this._processNewItem.bind(this,a))}var c=a.prototype;c._initSorting=function(){this._sortableGroup=new(b("SortableGroup"))().setDropCallback(function(a,c){new(b("AsyncRequest"))("/ajax/timeline/collections/reorder_items/").setData({order:this._sortableGroup.getOrder(),collection_token:this._collectionToken}).send()}.bind(this))};c._registerCollectionItems=function(a){a=b("DOMQuery").scry(a,"li[data-sort-id]");a.forEach(function(a){this._registerCollectionItem(a)},this)};c._registerCollectionItem=function(a){var b=a.getAttribute("data-sort-id");this._sortableGroup.removeSortable(b);window.setTimeout(this._sortableGroup.addSortable.bind(this._sortableGroup,b,a),500)};c._processNewItem=function(a,c,d){c=b("Parent").bySelector(d.grid,"._30f");if(a!==c.id)return;this._registerCollectionItem(d.newItem)};a.registerCollectionItems=function(a,b,c){a=j(a,b);a&&a._registerCollectionItems(c)};return a}();function j(a,c){var d=b("DataStore").get(b("$")(a),h);return d||new i(a,c)}e.exports=i}),null);
__d("TimelineInHouseOGCurationControl",["csx","CSS","DOM","Parent","ProfileTabUtils","TimelineAppCollection"],(function(a,b,c,d,e,f,g){__p&&__p();function a(a,c,d,e){__p&&__p();this._menu=a,this._collectionToken=c,this._popoverMenu=d,this._placeholderMarkup=e,this._menu.subscribe("itemclick",function(d,f){__p&&__p();d=f.item.getValue();var g="add_to_top",h="remove_from_top";if(d=="delete"||d=="recommend")return;if(d==c){f.item.deselect();a.done();return}var i=b("Parent").bySelector(this._popoverMenu,"._3owb");if(d=="highlight"){var j=b("DOM").scry(i,"._54_4");j[0]&&(!f.item.isSelected()?b("CSS").addClass(j[0],"selected"):b("CSS").removeClass(j[0],"selected"));a.done();return}else if(d&&d.substring(0,g.length)===g){b("TimelineAppCollection").addPlaceholderToCollection(d.substring(g.length+1),i.parentNode);a.done();return}else if(d&&d.substring(0,h.length)===h){f=d.substring(h.length+1);if(c!==f){b("TimelineAppCollection").decrementCount(b("ProfileTabUtils").getIDForCollectionToken(f));a.done();return}}i.appendChild(e);b("CSS").hide(b("DOM").find(i,"[data-collection-item-bg]"));b("CSS").hide(b("DOM").find(i,"[data-collection-item-priv]"));if(!d){a.done();return}b("TimelineAppCollection").decrementCount(b("ProfileTabUtils").getIDForCollectionToken(c));d.substring(0,15)!=h&&b("TimelineAppCollection").addPlaceholderToCollection(d,i.parentNode);a.done()}.bind(this))}e.exports=a}),null);