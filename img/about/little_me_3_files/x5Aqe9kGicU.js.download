if (self.CavalryLogger) { CavalryLogger.start_js(["SqB6A"]); }

__d("CometVisualCompletionUtil",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={filter:function(a){a=a;while(a){if(a.getAttribute("data-novc"))return!1;a=a.parentElement}return!0},getPixels:function(a){return(a.right-a.left)*(a.bottom-a.top)},getRectIntersection:function(a,b){return{bottom:Math.max(Math.min(a.bottom,b.bottom),b.top),left:Math.min(Math.max(a.left,b.left),b.right),right:Math.max(Math.min(a.right,b.right),b.left),top:Math.min(Math.max(a.top,b.top),b.bottom)}},getRectangle:function(a,b){a=a.getBoundingClientRect();var c=a.top,d=a.left,e=a.bottom;a=a.right;e={bottom:e,left:d,right:a,top:c};return g.getRectIntersection(e,b)},getViewportSize:function(){return{height:window.innerHeight,width:window.innerWidth}},isVisible:function(a){a=a;if(typeof a.getBoundingClientRect!=="function")return!1;var b=g.getViewportSize();a=g.getPixels(g.getRectangle(a,{bottom:b.height,left:0,right:b.width,top:0}));return a>0},trimHash:function(a){return a!=null&&a!==""?a.split("#")[0]:null}};e.exports=g}),null);
__d("CometVisualChangeObserver",["CometVisualCompletion","CometVisualCompletionUtil","JSScheduler","MutationObserver","gkx","performance","performanceAbsoluteNow"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=new Map(),h=1,i={attributes:!0,characterData:!0,childList:!0,subtree:!0};function j(a){a=b("performance").getEntriesByName(a);return a.length>0&&a[0].responseEnd}function k(a,c){__p&&__p();if(a!=null&&b("CometVisualCompletionUtil").isVisible(a)){if(b("gkx")("866850")&&!b("CometVisualCompletionUtil").filter(a))return;b("CometVisualCompletion").addVisualElement(a,c);if(typeof b("performance").getEntriesByName==="function"){c=a.querySelectorAll("img");Array.prototype.forEach.call(c,function(a){__p&&__p();if(a.src==null||a.src===""||a.src.indexOf("http")!==0)return;var c=a.src,d;c.indexOf("#")>=0&&(d=b("CometVisualCompletionUtil").trimHash(c));if(!j(c)&&(d==null||!j(d))){var e=new Image();e.onload=e.onerror=function(){b("CometVisualCompletion").imageDone(c),e=null};b("CometVisualCompletion").imageWait(c);e.src=a.src}})}}}var l=new(b("MutationObserver"))(function(a){var c=b("performanceAbsoluteNow")();b("JSScheduler").scheduleNormalPriCallback(function(){Array.prototype.forEach.call(a,function(a){a.type==="childList"&&a.addedNodes&&a.addedNodes.length?Array.prototype.forEach.call(a.addedNodes,function(a){return k(a,c)}):a.type==="attributes"&&a.attributeName==="style"&&k(a.target,c)})})});a={observe:function(a,c){c===void 0&&(c=!1);var d=h++;g.set(d,a);c||k(a,b("performanceAbsoluteNow")());l.observe(a,i);return function(){g["delete"](d)}},start:function(){g.forEach(function(a){l.observe(a,i)})},stop:function(){l.disconnect()}};e.exports=a}),null);
__d("CometVisualCompletionQPL",["CometInteractionTracingMetrics","CometVisualCompletionQuickLogModule","QuickPerformanceLogger","gkx","performanceAbsoluteNow"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("CometVisualCompletionQuickLogModule").COMET_VISUALLY_COMPLETE_WWW;function h(a){var c=b("CometInteractionTracingMetrics").get(a.traceId);c&&(c.metadata.containsDataFromOtherInteraction&&a.annotations.set("containsDataFromOtherInteraction",1))}function i(a){b("QuickPerformanceLogger").markerStart(g,0,a)}function j(a,c){h(a),a.markerPoints.forEach(function(c,d){var e=c.timestamp;c=c.data;b("QuickPerformanceLogger").markerPoint(g,d,c&&Object.keys(c).length?JSON.stringify(c):null,0,e+a.startTime)}),a.annotations.forEach(function(a,c){typeof a==="number"?b("QuickPerformanceLogger").annotateMarkerInt(g,c,a,0):b("QuickPerformanceLogger").annotateMarkerString(g,c,a,0)}),b("QuickPerformanceLogger").annotateMarkerString(g,"rendering_strategy_selection_implementation",b("gkx")("940313")?"parallel":"serial"),b("QuickPerformanceLogger").markerEnd(g,c,0,a.visuallyComplete+a.startTime)}function k(){b("QuickPerformanceLogger").markerDrop(g,0)}a={drop:function(){k()},logIncompleteVC:function(a){if(!a||a.tracePolicy==null||a.tracePolicy===""){k();return}a.visuallyComplete=b("performanceAbsoluteNow")()-a.startTime;j(a,"CANCEL")},logVC:function(a){a.tracePolicy==null||a.tracePolicy===""||a.visuallyComplete===0?k():j(a,"SUCCESS")},start:function(a){i(a)}};e.exports=a}),null);
__d("CometVisualCompletionTrace",["CometVisualCompletionUtil","VisibilityListener","gkx","performance","performanceAbsoluteNow","performanceNavigationStart"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=/url\(.*(http.*)\)/gi;function h(a){__p&&__p();var c=b("VisibilityListener").getHiddenTime(a.startTime,a.startTime+a.visuallyComplete);a.annotations.set("hidden",c!=null&&c>0?1:0);a.tracePolicy!=null&&a.tracePolicy!==""&&a.annotations.set("tracePolicy",a.tracePolicy);a.annotations.set("interactionId",a.traceId);a.annotations.set("height",a.viewport.height);a.annotations.set("width",a.viewport.width);a.annotations.set("scrollY",a.scrollY);a.annotations.set("overhead",a.calcLatency);a.annotations.set("navSequence",a.navSequence);a.markerPoints.set("speedIndex",{timestamp:a.speedIndex});a.navSequence===1&&b("performance")&&b("performance").timing&&(b("performance").timing.responseStart&&a.markerPoints.set("TTFB",{timestamp:b("performance").timing.responseStart-a.startTime}));a.elements.length&&(a.markerPoints.set("FP",{timestamp:a.elements[a.elements.length-1].latency}),a.vcWithoutImage>0&&a.markerPoints.set("vcWithoutImage",{timestamp:a.vcWithoutImage}))}a=function(){__p&&__p();function a(a,c,d){this.$8=0,this.$9=0,this.$10=0,this.$11=0,this.$5=new Map(),this.$3=new Map(),this.$1=[],this.$2=[],this.$7=0,this.$12=[],this.$4=a,this.$6=b("CometVisualCompletionUtil").getViewportSize(),this.navSequence=c,this.traceID=d,this.markerPoints=new Map(),this.annotations=new Map(),this.navDone=!1}var c=a.prototype;c.addAnnotation=function(a,b){this.annotations.set(a,b)};c.addMarkerPoint=function(a,b,c){c===void 0&&(c={}),this.markerPoints.set(a,{data:c,timestamp:b-this.$4})};c.addVisualElement=function(a,b){this.$12.push([a,b])};c.calculate=function(){__p&&__p();var a=this;if(!this.$12.length)return null;this.$6=b("CometVisualCompletionUtil").getViewportSize();var c=b("performanceAbsoluteNow")();this.$7=0;this.$9=0;this.$10=0;this.setResourceTimingMap();this.initTree();this.getImages();b("gkx")("679542")&&this.getBackgroundImages();this.$8=this.calculatePaintedPixels(this.$1,this.$6.width*this.$6.height);var d={annotations:this.annotations,bgCheckLatency:this.$10,bgChecked:this.$7,bgNum:0,bgPixels:0,calcLatency:0,compNum:0,compPixels:0,elements:this.$2,imgNum:0,imgPixels:0,markerPoints:this.markerPoints,navComplete:this.$11,navSequence:this.navSequence,paintedPixels:this.$9,scrollY:window.scrollY,speedIndex:0,startTime:this.$4,totalPixels:this.$8,traceId:this.traceID,tracePolicy:this.tracePolicy,vcWithoutImage:0,viewport:this.$6,visuallyComplete:0};this.$2.length&&(this.$2=this.$2.sort(function(a,b){return b.latency-a.latency}),d.visuallyComplete=this.$2[0].latency,this.$2.forEach(function(b){__p&&__p();d.vcWithoutImage===0&&b.type==="component"&&(d.vcWithoutImage=b.latency);d.speedIndex+=b.pixels/a.$9*b.latency;switch(b.type){case"component":d.compNum++;d.compPixels+=b.pixels;break;case"img":d.imgNum++;d.imgPixels+=b.pixels;break;case"bg":d.bgNum++;d.bgPixels+=b.pixels;break}}));d.calcLatency=b("performanceAbsoluteNow")()-c;h(d);return d};c.findParent=function(a){a=a.parentElement;while(a){var b=a.getAttribute("data-veid");if(b!=null&&b!==""&&this.$3.has(b))return this.$3.get(b);a=a.parentElement}return null};c.getBackgroundImages=function(){__p&&__p();var c=this,d=b("performanceAbsoluteNow")();this.$1.forEach(function(d){__p&&__p();d=d.element.querySelectorAll(":not(img)");Array.prototype.forEach.call(d,function(d){__p&&__p();if(b("gkx")("866850")&&!b("CometVisualCompletionUtil").filter(d))return;var e=c.findParent(d);if(!e)return;var f=b("CometVisualCompletionUtil").getRectangle(d,e.rectangle),g=b("CometVisualCompletionUtil").getPixels(f);if(!g)return;var h=b("CometVisualCompletionUtil").trimHash(c.getStyleBackground(d));if(h!=null&&h!==""&&c.$5.has(h)){d={children:[],element:d,latency:c.$5.get(h)+b("performanceNavigationStart")()-c.$4,parent:e,pixels:g,rectangle:f,timestamp:c.$5.get(h)+b("performanceNavigationStart")(),type:"bg",url:h,veid:String(a.$13++)};e.children.push(d)}})});this.$10=b("performanceAbsoluteNow")()-d};c.getImages=function(){__p&&__p();var c=this,d=document.querySelectorAll("img");Array.prototype.forEach.call(d,function(d){__p&&__p();if(typeof d.currentSrc!=="string"||d.currentSrc==="")return;if(b("gkx")("866850")&&!b("CometVisualCompletionUtil").filter(d))return;var e=c.findParent(d);if(!e)return;var f=b("CometVisualCompletionUtil").getRectangle(d,e.rectangle);if(d.parentElement){var g=b("CometVisualCompletionUtil").getRectangle(d.parentElement,e.rectangle);f=b("CometVisualCompletionUtil").getRectIntersection(f,g)}g=b("CometVisualCompletionUtil").getPixels(f);if(!g)return;var h=d.currentSrc;h=b("CometVisualCompletionUtil").trimHash(h);if(h!=null&&h!==""&&c.$5.has(h)){d={children:[],element:d,latency:c.$5.get(h)+b("performanceNavigationStart")()-c.$4,parent:e,pixels:g,rectangle:f,timestamp:c.$5.get(h)+b("performanceNavigationStart")(),type:"img",url:h,veid:String(a.$13++)};e.children.push(d)}})};c.getStyleBackground=function(a){__p&&__p();if(typeof window.getComputedStyle!=="function")return null;this.$7++;a=window.getComputedStyle(a);var b=a["background-image"];if(a.visibility!=="hidden"&&b&&b!=="none"){g.lastIndex=0;a=g.exec(b);if(a&&a.length>1)return a[1].replace('"',"")}return null};c.initTree=function(){__p&&__p();var c=this,d={bottom:this.$6.height,left:0,right:this.$6.width,top:0};this.$12.forEach(function(e){var f=e[0];e=e[1];var g=b("CometVisualCompletionUtil").getRectangle(f,d);if(b("CometVisualCompletionUtil").isVisible(f)){g={children:[],element:f,latency:e-c.$4,parent:null,pixels:b("CometVisualCompletionUtil").getPixels(g),rectangle:g,timestamp:e,type:"component",veid:String(a.$13++)};f.setAttribute("data-veid",g.veid);c.$3.set(g.veid,g)}});this.$3.forEach(function(a){var d=c.findParent(a.element);d?(a.rectangle=b("CometVisualCompletionUtil").getRectIntersection(a.rectangle,d.rectangle),a.pixels=b("CometVisualCompletionUtil").getPixels(a.rectangle),d.children.push(a),a.parent=d):c.$1.push(a)})};c.setResourceTimingMap=function(){var a=this;if(typeof b("performance").getEntriesByType==="function"){var c=b("performance").getEntriesByType("resource");c.forEach(function(c){var d=b("CometVisualCompletionUtil").trimHash(c.name);d!=null&&d!==""&&a.$5.set(d,c.responseEnd)})}};c.calculatePaintedPixels=function(a,b){var c=this,d=b,e=0;a.sort(function(a,b){return b.timestamp-a.timestamp}).forEach(function(a){a.pixels=Math.min(d,a.pixels),e+=a.pixels,d-=a.pixels,a.pixels-=c.calculatePaintedPixels(a.children,a.pixels),a.timestamp>c.$4&&(a.type!=="component"&&a.parent&&a.parent.timestamp>a.timestamp&&(a.latency=a.parent.latency),c.$9+=a.pixels,c.$2.push(a))});return e};c.setNavCompleteTime=function(a){this.$11=a,this.navDone=!0};c.setTracePolicy=function(a){this.tracePolicy=a};return a}();a.$13=1;e.exports=a}),null);
__d("CometVisualCompletion",["CometInteractionTracingMetrics","CometVisualChangeObserver","CometVisualCompletionQPL","CometVisualCompletionTrace","CometVisualCompletionUtil","IntersectionObserver","JSTraceListener","JSTracing","URLSearchParams","gkx","intersectionObserverEntryIsIntersecting","performanceAbsoluteNow","setTimeoutCometLoggingPri"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=0,h=new Set(),i=new Set(),j=null,k=new Map(),l=null;if(b("gkx")("926112")&&window.location.href.contains("browserLabTag=")){a=new(b("URLSearchParams"))(window.location.search);l=a.get("browserLabTag")}var m=500,n,o=[];function p(){o.forEach(function(a){a(n)}),r.logQPL()}function q(){if(j==null||n||h.size>0||i.size>0)return;n=j.calculate();p()}var r={addAnnotation:function(a,b){j!=null&&j.addAnnotation(a,b)},addMarkerPoint:function(a,c,d){c===void 0&&(c=b("performanceAbsoluteNow")()),d===void 0&&(d={}),j!=null&&c!=null&&c>0&&j.addMarkerPoint(a,c,d)},addRenderingInfo:function(a,c,d){__p&&__p();if(j!=null&&n==null&&a!=null){var e=[],f=b("JSTracing").getCurrent();f&&f.size&&f.forEach(function(a){a=b("CometInteractionTracingMetrics").get(a.name);e.push(a?a.type:"UNKNOWN")});f=r.isVisible(a)?1:0;a=b("performanceAbsoluteNow")();var g={interaction:e.join(","),position:d,visible:f};d<10&&r.addMarkerPoint("Render_"+c+"_"+d,a,g);f===1&&r.addMarkerPoint("Render_"+c+"_LastVisible",a,g)}},addTracedInteraction:function(a,c,d){var e=1,f=null;k.get(a)&&(e=k.get(a)+1);k.set(a,e);j!=null&&(f=j.traceID,j.addMarkerPoint(a+"_"+e+"_start",b("performanceAbsoluteNow")(),{interactionId:c,qplEvent:d}));return function(){j!=null&&j.addMarkerPoint(j.traceID===f?a+"_"+e+"_end":"prev_"+a+"_"+e+"_end",b("performanceAbsoluteNow")(),{interactionId:c,qplEvent:d})}},addVisualElement:function(a,c){c===void 0&&(c=b("performanceAbsoluteNow")()),j!=null&&a!=null&&j.addVisualElement(a,c)},dumpWaits:function(){return[h,i]},getReport:function(){return n},holdTrigger:function(a,c){__p&&__p();h.add(a);if(c){var d=function(c,d){Array.prototype.forEach.call(c,function(c){b("intersectionObserverEntryIsIntersecting")(c)||(d.disconnect(),r.resumeTrigger(a))})},e=new(b("IntersectionObserver"))(d);e.observe(c);return function(){e.disconnect(),r.resumeTrigger(a)}}return function(){r.resumeTrigger(a)}},imageDone:function(a){if(!i.has(a))return;i["delete"](a);q()},imageWait:function(a){i.add(a)},isVisible:function(a){return b("CometVisualCompletionUtil").isVisible(a)},logQPL:function(){n&&b("CometVisualCompletionQPL").logVC(n)},resumeTrigger:function(a){if(!h.has(a))return;h["delete"](a);b("setTimeoutCometLoggingPri")(function(){!n&&h.size===0&&(b("CometVisualChangeObserver").stop(),q())},m)},setRoute:function(a){j!=null&&a!=null&&j.setTracePolicy(a)},subscribe:function(a){o.push(a)},traceNavigation:function(a,c){__p&&__p();c===void 0&&(c=b("performanceAbsoluteNow")());var d=null;if(j!=null&&n==null){d=j.traceID;j.addAnnotation("incompleteWaitCount",h.size);j.addAnnotation("incompleteImageCount",i.size);j.addAnnotation("incomplete",1);var e=j.calculate();b("CometVisualCompletionQPL").logIncompleteVC(e)}b("CometVisualCompletionQPL").start(c);j=new(b("CometVisualCompletionTrace"))(c,++g,a);d!=null&&j.addAnnotation("incompletePreviousTrace",d);l!=null&&l!==""&&j.addAnnotation("browserLabTag",l);n=null;k.clear();h.clear();i.clear();r.holdTrigger(a);b("JSTraceListener")(a).onComplete(function(b,c){j!=null&&a===j.traceID&&(c!=null&&j.setNavCompleteTime(b-c.start),r.resumeTrigger(a))});p()},unsubscribe:function(a){o=o.filter(function(b){return b!==a})}};e.exports=r}),null);